\hypertarget{hash_8c}{\section{src/container/hash.c File Reference}
\label{hash_8c}\index{src/container/hash.\-c@{src/container/hash.\-c}}
}
{\ttfamily \#include \char`\"{}hash.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../libc/libc.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../math/math.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../utils/utils.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../memory/memory.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../platform/platform.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../algorithm/algorithm.\-h\char`\"{}}\\*
Include dependency graph for hash.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d44/hash_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{hash_8c_a470e75d63f9d8abc8529d664a7d56403}{\#define {\bfseries T\-B\-\_\-\-H\-A\-S\-H\-\_\-\-I\-N\-D\-E\-X\-\_\-\-M\-A\-K\-E}(buck, item)~(((tb\-\_\-size\-\_\-t)((item) \& 0xffff) $<$$<$ 16) $\vert$ (buck) \& 0xffff)}\label{hash_8c_a470e75d63f9d8abc8529d664a7d56403}

\item 
\hypertarget{hash_8c_a1e9ff828bfacd3bff1c9a76e23152571}{\#define {\bfseries T\-B\-\_\-\-H\-A\-S\-H\-\_\-\-I\-N\-D\-E\-X\-\_\-\-B\-U\-C\-K}(index)~((index) \& 0xffff)}\label{hash_8c_a1e9ff828bfacd3bff1c9a76e23152571}

\item 
\hypertarget{hash_8c_a573210267b1d3906076c760599ef63f2}{\#define {\bfseries T\-B\-\_\-\-H\-A\-S\-H\-\_\-\-I\-N\-D\-E\-X\-\_\-\-I\-T\-E\-M}(index)~(((index) $>$$>$ 16) \& 0xffff)}\label{hash_8c_a573210267b1d3906076c760599ef63f2}

\item 
\hypertarget{hash_8c_a4660ae1b578f18574ae312fe68ac5fb0}{\#define {\bfseries T\-B\-\_\-\-H\-A\-S\-H\-\_\-\-G\-R\-O\-W\-\_\-\-M\-I\-N}~(8)}\label{hash_8c_a4660ae1b578f18574ae312fe68ac5fb0}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$ \hyperlink{hash_8c_aeece2d7710c34f88df1ddaeb7e35309a}{tb\-\_\-hash\-\_\-init} (tb\-\_\-size\-\_\-t size, \hyperlink{structtb__item__func__t}{tb\-\_\-item\-\_\-func\-\_\-t} name\-\_\-func, \hyperlink{structtb__item__func__t}{tb\-\_\-item\-\_\-func\-\_\-t} data\-\_\-func)
\item 
tb\-\_\-void\-\_\-t \hyperlink{hash_8c_a333a1f40ac1a3448e4d98723092c5fe1}{tb\-\_\-hash\-\_\-exit} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$handle)
\item 
tb\-\_\-void\-\_\-t \hyperlink{hash_8c_a2a9bcad58d83f0c028d25d1949fe2814}{tb\-\_\-hash\-\_\-clear} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$handle)
\item 
tb\-\_\-size\-\_\-t \hyperlink{hash_8c_a906c8acc1eea8cbd6f633e9c791f5934}{tb\-\_\-hash\-\_\-itor} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} const $\ast$handle, tb\-\_\-cpointer\-\_\-t name)
\item 
tb\-\_\-pointer\-\_\-t \hyperlink{hash_8c_a67fbcf28b4c55b2bfc553bc379ee31ce}{tb\-\_\-hash\-\_\-get} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} const $\ast$handle, tb\-\_\-cpointer\-\_\-t name)
\item 
tb\-\_\-void\-\_\-t \hyperlink{hash_8c_a154018e2100ed86f3869edf7b61bdd16}{tb\-\_\-hash\-\_\-del} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$handle, tb\-\_\-cpointer\-\_\-t name)
\item 
tb\-\_\-size\-\_\-t \hyperlink{hash_8c_abe63b86f381489b85e938fe0eb03b860}{tb\-\_\-hash\-\_\-set} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$handle, tb\-\_\-cpointer\-\_\-t name, tb\-\_\-cpointer\-\_\-t data)
\item 
tb\-\_\-size\-\_\-t \hyperlink{hash_8c_aa69c93f0e6d9231c2dbc0562575e5304}{tb\-\_\-hash\-\_\-size} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} const $\ast$handle)
\item 
tb\-\_\-size\-\_\-t \hyperlink{hash_8c_a5a8a616b4c6f94febbeb4ccda705f8dd}{tb\-\_\-hash\-\_\-maxn} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} const $\ast$handle)
\item 
tb\-\_\-void\-\_\-t \hyperlink{hash_8c_a4541496b74b93a94ad9056ef298a3421}{tb\-\_\-hash\-\_\-walk} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$handle, tb\-\_\-bool\-\_\-t($\ast$func)(\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} $\ast$hash, \hyperlink{structtb__hash__item__t}{tb\-\_\-hash\-\_\-item\-\_\-t} $\ast$item, tb\-\_\-bool\-\_\-t $\ast$bdel, tb\-\_\-pointer\-\_\-t priv), tb\-\_\-pointer\-\_\-t priv)
\item 
tb\-\_\-void\-\_\-t \hyperlink{hash_8c_a6bf8d9e02af918b857a099015aa7110b}{tb\-\_\-hash\-\_\-dump} (\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\-\_\-hash\-\_\-t} const $\ast$handle)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Treasure Box Library

T\-Box is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; either version 2.\-1 of the License, or (at your option) any later version.

T\-Box is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U Lesser General Public License for more details.

You should have received a copy of the G\-N\-U Lesser General Public License along with T\-Box; If not, see \href{http://www.gnu.org/licenses/}{\tt http\-://www.\-gnu.\-org/licenses/}

Copyright (C) 2009 -\/ 2015, ruki All rights reserved.

\begin{DoxyAuthor}{Author}
ruki 
\end{DoxyAuthor}


Definition in file \hyperlink{hash_8c_source}{hash.\-c}.



\subsection{Function Documentation}
\hypertarget{hash_8c_a2a9bcad58d83f0c028d25d1949fe2814}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-clear@{tb\-\_\-hash\-\_\-clear}}
\index{tb\-\_\-hash\-\_\-clear@{tb\-\_\-hash\-\_\-clear}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-clear}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-hash\-\_\-clear (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} $\ast$}]{hash}
\end{DoxyParamCaption}
)}}\label{hash_8c_a2a9bcad58d83f0c028d25d1949fe2814}
clear hash


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
\end{DoxyParams}


Definition at line 443 of file hash.\-c.



Referenced by tb\-\_\-hash\-\_\-exit().

\hypertarget{hash_8c_a154018e2100ed86f3869edf7b61bdd16}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-del@{tb\-\_\-hash\-\_\-del}}
\index{tb\-\_\-hash\-\_\-del@{tb\-\_\-hash\-\_\-del}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-del}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-hash\-\_\-del (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} $\ast$}]{hash, }
\item[{tb\-\_\-cpointer\-\_\-t}]{name}
\end{DoxyParamCaption}
)}}\label{hash_8c_a154018e2100ed86f3869edf7b61bdd16}
del hash item


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
{\em name} & the hash item name \\
\hline
\end{DoxyParams}


Definition at line 512 of file hash.\-c.



Referenced by tb\-\_\-dictionary\-\_\-del().

\hypertarget{hash_8c_a6bf8d9e02af918b857a099015aa7110b}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-dump@{tb\-\_\-hash\-\_\-dump}}
\index{tb\-\_\-hash\-\_\-dump@{tb\-\_\-hash\-\_\-dump}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-dump}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-hash\-\_\-dump (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} const $\ast$}]{hash}
\end{DoxyParamCaption}
)}}\label{hash_8c_a6bf8d9e02af918b857a099015aa7110b}
dump hash


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
\end{DoxyParams}


Definition at line 741 of file hash.\-c.



References tb\-\_\-for\-\_\-all.

\hypertarget{hash_8c_a333a1f40ac1a3448e4d98723092c5fe1}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-exit@{tb\-\_\-hash\-\_\-exit}}
\index{tb\-\_\-hash\-\_\-exit@{tb\-\_\-hash\-\_\-exit}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-hash\-\_\-exit (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} $\ast$}]{hash}
\end{DoxyParamCaption}
)}}\label{hash_8c_a333a1f40ac1a3448e4d98723092c5fe1}
exit hash


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
\end{DoxyParams}


Definition at line 428 of file hash.\-c.



References tb\-\_\-hash\-\_\-clear().



Referenced by tb\-\_\-hash\-\_\-init().

\hypertarget{hash_8c_a67fbcf28b4c55b2bfc553bc379ee31ce}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-get@{tb\-\_\-hash\-\_\-get}}
\index{tb\-\_\-hash\-\_\-get@{tb\-\_\-hash\-\_\-get}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-get}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-pointer\-\_\-t tb\-\_\-hash\-\_\-get (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} const $\ast$}]{hash, }
\item[{tb\-\_\-cpointer\-\_\-t}]{name}
\end{DoxyParamCaption}
)}}\label{hash_8c_a67fbcf28b4c55b2bfc553bc379ee31ce}
get hash item data


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
{\em name} & the hash item name\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the hash item data 
\end{DoxyReturn}


Definition at line 496 of file hash.\-c.



Referenced by tb\-\_\-dictionary\-\_\-val(), and tb\-\_\-dns\-\_\-cache\-\_\-get().

\hypertarget{hash_8c_aeece2d7710c34f88df1ddaeb7e35309a}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-init@{tb\-\_\-hash\-\_\-init}}
\index{tb\-\_\-hash\-\_\-init@{tb\-\_\-hash\-\_\-init}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-hash\-\_\-t}$\ast$ tb\-\_\-hash\-\_\-init (
\begin{DoxyParamCaption}
\item[{tb\-\_\-size\-\_\-t}]{size, }
\item[{{\bf tb\-\_\-item\-\_\-func\-\_\-t}}]{name\-\_\-func, }
\item[{{\bf tb\-\_\-item\-\_\-func\-\_\-t}}]{data\-\_\-func}
\end{DoxyParamCaption}
)}}\label{hash_8c_aeece2d7710c34f88df1ddaeb7e35309a}
init hash


\begin{DoxyParams}{Parameters}
{\em size} & the hash size \\
\hline
{\em name\-\_\-func} & the hash name func \\
\hline
{\em data\-\_\-func} & the hash data func\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the hash 
\end{DoxyReturn}


Definition at line 385 of file hash.\-c.



References tb\-\_\-item\-\_\-func\-\_\-t\-::dupl, tb\-\_\-item\-\_\-func\-\_\-t\-::hash, tb\-\_\-item\-\_\-func\-\_\-t\-::repl, tb\-\_\-item\-\_\-func\-\_\-t\-::size, tb\-\_\-hash\-\_\-exit(), and T\-B\-\_\-\-I\-T\-E\-R\-A\-T\-O\-R\-\_\-\-M\-O\-D\-E\-\_\-\-F\-O\-R\-W\-A\-R\-D.



Referenced by tb\-\_\-dictionary\-\_\-init(), and tb\-\_\-scache\-\_\-init().

\hypertarget{hash_8c_a906c8acc1eea8cbd6f633e9c791f5934}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-itor@{tb\-\_\-hash\-\_\-itor}}
\index{tb\-\_\-hash\-\_\-itor@{tb\-\_\-hash\-\_\-itor}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-itor}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-size\-\_\-t tb\-\_\-hash\-\_\-itor (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} const $\ast$}]{hash, }
\item[{tb\-\_\-cpointer\-\_\-t}]{name}
\end{DoxyParamCaption}
)}}\label{hash_8c_a906c8acc1eea8cbd6f633e9c791f5934}
get hash item itor


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
{\em name} & the hash item name\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the hash itor, 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
\-: itor =$>$ item maybe changed if insert or remove item 
\end{DoxyNote}


Definition at line 485 of file hash.\-c.



Referenced by tb\-\_\-scache\-\_\-del(), and tb\-\_\-scache\-\_\-put().

\hypertarget{hash_8c_a5a8a616b4c6f94febbeb4ccda705f8dd}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-maxn@{tb\-\_\-hash\-\_\-maxn}}
\index{tb\-\_\-hash\-\_\-maxn@{tb\-\_\-hash\-\_\-maxn}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-maxn}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-size\-\_\-t tb\-\_\-hash\-\_\-maxn (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} const $\ast$}]{hash}
\end{DoxyParamCaption}
)}}\label{hash_8c_a5a8a616b4c6f94febbeb4ccda705f8dd}
the hash maxn


\begin{DoxyParams}{Parameters}
{\em hash} & the hash\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the hash maxn 
\end{DoxyReturn}


Definition at line 622 of file hash.\-c.

\hypertarget{hash_8c_abe63b86f381489b85e938fe0eb03b860}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-set@{tb\-\_\-hash\-\_\-set}}
\index{tb\-\_\-hash\-\_\-set@{tb\-\_\-hash\-\_\-set}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-size\-\_\-t tb\-\_\-hash\-\_\-set (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} $\ast$}]{hash, }
\item[{tb\-\_\-cpointer\-\_\-t}]{name, }
\item[{tb\-\_\-cpointer\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{hash_8c_abe63b86f381489b85e938fe0eb03b860}
set hash item


\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
{\em name} & the hash item name \\
\hline
{\em data} & the hash item data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the hash itor, 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
\-: itor =$>$ item maybe changed if insert or remove item 
\end{DoxyNote}


Definition at line 524 of file hash.\-c.



Referenced by tb\-\_\-dictionary\-\_\-set(), tb\-\_\-dns\-\_\-cache\-\_\-set(), tb\-\_\-scache\-\_\-put(), and tb\-\_\-tstore\-\_\-setp().

\hypertarget{hash_8c_aa69c93f0e6d9231c2dbc0562575e5304}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-size@{tb\-\_\-hash\-\_\-size}}
\index{tb\-\_\-hash\-\_\-size@{tb\-\_\-hash\-\_\-size}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-size}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-size\-\_\-t tb\-\_\-hash\-\_\-size (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} const $\ast$}]{hash}
\end{DoxyParamCaption}
)}}\label{hash_8c_aa69c93f0e6d9231c2dbc0562575e5304}
the hash size


\begin{DoxyParams}{Parameters}
{\em hash} & the hash\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the hash size 
\end{DoxyReturn}


Definition at line 616 of file hash.\-c.



Referenced by tb\-\_\-dictionary\-\_\-size(), tb\-\_\-dns\-\_\-cache\-\_\-get(), and tb\-\_\-dns\-\_\-cache\-\_\-set().

\hypertarget{hash_8c_a4541496b74b93a94ad9056ef298a3421}{\index{hash.\-c@{hash.\-c}!tb\-\_\-hash\-\_\-walk@{tb\-\_\-hash\-\_\-walk}}
\index{tb\-\_\-hash\-\_\-walk@{tb\-\_\-hash\-\_\-walk}!hash.c@{hash.\-c}}
\subsubsection[{tb\-\_\-hash\-\_\-walk}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-hash\-\_\-walk (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-hash\-\_\-t} $\ast$}]{hash, }
\item[{tb\-\_\-bool\-\_\-t($\ast$)({\bf tb\-\_\-hash\-\_\-t} $\ast$hash, {\bf tb\-\_\-hash\-\_\-item\-\_\-t} $\ast$item, tb\-\_\-bool\-\_\-t $\ast$bdel, tb\-\_\-pointer\-\_\-t priv)}]{func, }
\item[{tb\-\_\-pointer\-\_\-t}]{priv}
\end{DoxyParamCaption}
)}}\label{hash_8c_a4541496b74b93a94ad9056ef298a3421}
walk hash items

be faster than the iterator mode, optimizate to remove items for walking


\begin{DoxyCode}
tb\_bool\_t tb\_hash\_item\_func(\hyperlink{hash_8h_a20fa45d33fbfafc47804d515901019d6}{tb\_hash\_t}* hash, \hyperlink{structtb__hash__item__t}{tb\_hash\_item\_t}* item, tb\_bool\_t* bdel, 
      tb\_pointer\_t priv)
\{
        tb\_assert\_and\_check\_return\_val(hash && bdel, tb\_false);

        \textcolor{comment}{// delete it?}
        \textcolor{comment}{// *bdel = tb\_true;}

        \textcolor{comment}{// continue or break}
        \textcolor{keywordflow}{return} tb\_true;
\}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em hash} & the hash \\
\hline
{\em func} & the walk callback func \\
\hline
{\em data} & the walk callback data \\
\hline
\end{DoxyParams}


Definition at line 628 of file hash.\-c.



References tb\-\_\-hash\-\_\-item\-\_\-t\-::data, and tb\-\_\-hash\-\_\-item\-\_\-t\-::name.



Referenced by tb\-\_\-dns\-\_\-cache\-\_\-set().

