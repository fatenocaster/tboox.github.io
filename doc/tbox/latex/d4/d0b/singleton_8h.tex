\hypertarget{singleton_8h}{\section{src/tbox/utils/singleton.h File Reference}
\label{singleton_8h}\index{src/tbox/utils/singleton.\-h@{src/tbox/utils/singleton.\-h}}
}
{\ttfamily \#include \char`\"{}prefix.\-h\char`\"{}}\\*
Include dependency graph for singleton.\-h\-:
This graph shows which files directly or indirectly include this file\-:
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\hypertarget{singleton_8h_a1aa604a7c38032e84c3128fed7238692}{typedef tb\-\_\-handle\-\_\-t($\ast$ \hyperlink{singleton_8h_a1aa604a7c38032e84c3128fed7238692}{tb\-\_\-singleton\-\_\-init\-\_\-func\-\_\-t} )(tb\-\_\-cpointer\-\_\-t $\ast$ppriv)}\label{singleton_8h_a1aa604a7c38032e84c3128fed7238692}

\begin{DoxyCompactList}\small\item\em the singleton init func type \end{DoxyCompactList}\item 
\hypertarget{singleton_8h_a669c643f7499cd3c0bab71ede1fd3bc6}{typedef tb\-\_\-void\-\_\-t($\ast$ \hyperlink{singleton_8h_a669c643f7499cd3c0bab71ede1fd3bc6}{tb\-\_\-singleton\-\_\-exit\-\_\-func\-\_\-t} )(tb\-\_\-handle\-\_\-t instance, tb\-\_\-cpointer\-\_\-t priv)}\label{singleton_8h_a669c643f7499cd3c0bab71ede1fd3bc6}

\begin{DoxyCompactList}\small\item\em the singleton exit func type \end{DoxyCompactList}\item 
\hypertarget{singleton_8h_a809be072c9425771e250cefd90ea72e0}{typedef tb\-\_\-void\-\_\-t($\ast$ \hyperlink{singleton_8h_a809be072c9425771e250cefd90ea72e0}{tb\-\_\-singleton\-\_\-kill\-\_\-func\-\_\-t} )(tb\-\_\-handle\-\_\-t instance, tb\-\_\-cpointer\-\_\-t priv)}\label{singleton_8h_a809be072c9425771e250cefd90ea72e0}

\begin{DoxyCompactList}\small\item\em the singleton kill func type \end{DoxyCompactList}\item 
\hypertarget{singleton_8h_aea8cb52294807ccfcf575f42ed4253c7}{typedef tb\-\_\-bool\-\_\-t($\ast$ \hyperlink{singleton_8h_aea8cb52294807ccfcf575f42ed4253c7}{tb\-\_\-singleton\-\_\-static\-\_\-init\-\_\-func\-\_\-t} )(tb\-\_\-handle\-\_\-t instance)}\label{singleton_8h_aea8cb52294807ccfcf575f42ed4253c7}

\begin{DoxyCompactList}\small\item\em the singleton static init func type \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{singleton_8h_af41cf41a99718526145ede2ba773585b}{tb\-\_\-singleton\-\_\-type\-\_\-e} \{ \\*
\hyperlink{singleton_8h_af41cf41a99718526145ede2ba773585ba99dc7aa7e1a04fd7f73507766d4dfbcc}{T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-A\-R\-G\-E\-\_\-\-P\-O\-O\-L} = 0, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-P\-O\-O\-L} = 1, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-O\-C\-K\-\_\-\-P\-R\-O\-F\-I\-L\-E\-R} = 2, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-R\-A\-N\-D\-O\-M} = 3, 
\\*
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-A\-I\-C\-P} = 4, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-I\-B\-R\-A\-R\-Y\-\_\-\-O\-P\-E\-N\-S\-S\-L} = 5, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-I\-B\-R\-A\-R\-Y\-\_\-\-M\-Y\-S\-Q\-L} = 6, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-I\-B\-R\-A\-R\-Y\-\_\-\-S\-Q\-L\-I\-T\-E3} = 7, 
\\*
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-T\-H\-R\-E\-A\-D\-\_\-\-P\-O\-O\-L} = 8, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-T\-R\-A\-N\-S\-F\-E\-R\-\_\-\-P\-O\-O\-L} = 9, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-C\-O\-O\-K\-I\-E\-S} = 10, 
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-U\-S\-E\-R} = 11, 
\\*
{\bfseries T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-A\-X\-N} = 128
 \}
\begin{DoxyCompactList}\small\item\em the singleton type enum \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
tb\-\_\-bool\-\_\-t \hyperlink{singleton_8h_a018988795da5e1683c35ce6f39f0e73a}{tb\-\_\-singleton\-\_\-init} (tb\-\_\-noarg\-\_\-t)
\item 
tb\-\_\-void\-\_\-t \hyperlink{singleton_8h_a65dc60604d75063ea918963be7e96f1a}{tb\-\_\-singleton\-\_\-kill} (tb\-\_\-noarg\-\_\-t)
\item 
tb\-\_\-void\-\_\-t \hyperlink{singleton_8h_a98161f27bd2894dc531fa20b29cb1e2a}{tb\-\_\-singleton\-\_\-exit} (tb\-\_\-noarg\-\_\-t)
\item 
tb\-\_\-handle\-\_\-t \hyperlink{singleton_8h_ae2d051d2b0f9d1e57edc719bafb025d1}{tb\-\_\-singleton\-\_\-instance} (tb\-\_\-size\-\_\-t type, \hyperlink{singleton_8h_a1aa604a7c38032e84c3128fed7238692}{tb\-\_\-singleton\-\_\-init\-\_\-func\-\_\-t} init, \hyperlink{singleton_8h_a669c643f7499cd3c0bab71ede1fd3bc6}{tb\-\_\-singleton\-\_\-exit\-\_\-func\-\_\-t} exit, \hyperlink{singleton_8h_a809be072c9425771e250cefd90ea72e0}{tb\-\_\-singleton\-\_\-kill\-\_\-func\-\_\-t} kill)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{singleton_8h_a577bbab4c6744ec29087ef1b25e83ed0}{tb\-\_\-singleton\-\_\-static\-\_\-init} (tb\-\_\-atomic\-\_\-t $\ast$binited, tb\-\_\-handle\-\_\-t instance, \hyperlink{singleton_8h_aea8cb52294807ccfcf575f42ed4253c7}{tb\-\_\-singleton\-\_\-static\-\_\-init\-\_\-func\-\_\-t} init)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Treasure Box Library

T\-Box is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; either version 2.\-1 of the License, or (at your option) any later version.

T\-Box is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U Lesser General Public License for more details.

You should have received a copy of the G\-N\-U Lesser General Public License along with T\-Box; If not, see \href{http://www.gnu.org/licenses/}{\tt http\-://www.\-gnu.\-org/licenses/}

Copyright (C) 2009 -\/ 2015, ruki All rights reserved.

\begin{DoxyAuthor}{Author}
ruki 
\end{DoxyAuthor}


Definition in file \hyperlink{singleton_8h_source}{singleton.\-h}.



\subsection{Enumeration Type Documentation}
\hypertarget{singleton_8h_af41cf41a99718526145ede2ba773585b}{\index{singleton.\-h@{singleton.\-h}!tb\-\_\-singleton\-\_\-type\-\_\-e@{tb\-\_\-singleton\-\_\-type\-\_\-e}}
\index{tb\-\_\-singleton\-\_\-type\-\_\-e@{tb\-\_\-singleton\-\_\-type\-\_\-e}!singleton.h@{singleton.\-h}}
\subsubsection[{tb\-\_\-singleton\-\_\-type\-\_\-e}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf tb\-\_\-singleton\-\_\-type\-\_\-e}}}\label{singleton_8h_af41cf41a99718526145ede2ba773585b}


the singleton type enum 

\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-A\-R\-G\-E\-\_\-\-P\-O\-O\-L@{T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-A\-R\-G\-E\-\_\-\-P\-O\-O\-L}!singleton.\-h@{singleton.\-h}}\index{singleton.\-h@{singleton.\-h}!T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-A\-R\-G\-E\-\_\-\-P\-O\-O\-L@{T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-A\-R\-G\-E\-\_\-\-P\-O\-O\-L}}\item[{\em 
\hypertarget{singleton_8h_af41cf41a99718526145ede2ba773585ba99dc7aa7e1a04fd7f73507766d4dfbcc}{T\-B\-\_\-\-S\-I\-N\-G\-L\-E\-T\-O\-N\-\_\-\-T\-Y\-P\-E\-\_\-\-L\-A\-R\-G\-E\-\_\-\-P\-O\-O\-L}\label{singleton_8h_af41cf41a99718526145ede2ba773585ba99dc7aa7e1a04fd7f73507766d4dfbcc}
}]the large pool type \end{description}
\end{Desc}


Definition at line 42 of file singleton.\-h.



\subsection{Function Documentation}
\hypertarget{singleton_8h_a98161f27bd2894dc531fa20b29cb1e2a}{\index{singleton.\-h@{singleton.\-h}!tb\-\_\-singleton\-\_\-exit@{tb\-\_\-singleton\-\_\-exit}}
\index{tb\-\_\-singleton\-\_\-exit@{tb\-\_\-singleton\-\_\-exit}!singleton.h@{singleton.\-h}}
\subsubsection[{tb\-\_\-singleton\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-singleton\-\_\-exit (
\begin{DoxyParamCaption}
\item[{tb\-\_\-noarg\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{singleton_8h_a98161f27bd2894dc531fa20b29cb1e2a}
exit singleton \hypertarget{singleton_8h_a018988795da5e1683c35ce6f39f0e73a}{\index{singleton.\-h@{singleton.\-h}!tb\-\_\-singleton\-\_\-init@{tb\-\_\-singleton\-\_\-init}}
\index{tb\-\_\-singleton\-\_\-init@{tb\-\_\-singleton\-\_\-init}!singleton.h@{singleton.\-h}}
\subsubsection[{tb\-\_\-singleton\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-singleton\-\_\-init (
\begin{DoxyParamCaption}
\item[{tb\-\_\-noarg\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{singleton_8h_a018988795da5e1683c35ce6f39f0e73a}
init singleton

\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Referenced by tb\-\_\-init\-\_\-().

\hypertarget{singleton_8h_ae2d051d2b0f9d1e57edc719bafb025d1}{\index{singleton.\-h@{singleton.\-h}!tb\-\_\-singleton\-\_\-instance@{tb\-\_\-singleton\-\_\-instance}}
\index{tb\-\_\-singleton\-\_\-instance@{tb\-\_\-singleton\-\_\-instance}!singleton.h@{singleton.\-h}}
\subsubsection[{tb\-\_\-singleton\-\_\-instance}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-handle\-\_\-t tb\-\_\-singleton\-\_\-instance (
\begin{DoxyParamCaption}
\item[{tb\-\_\-size\-\_\-t}]{type, }
\item[{{\bf tb\-\_\-singleton\-\_\-init\-\_\-func\-\_\-t}}]{init, }
\item[{{\bf tb\-\_\-singleton\-\_\-exit\-\_\-func\-\_\-t}}]{exit, }
\item[{{\bf tb\-\_\-singleton\-\_\-kill\-\_\-func\-\_\-t}}]{kill}
\end{DoxyParamCaption}
)}}\label{singleton_8h_ae2d051d2b0f9d1e57edc719bafb025d1}
the singleton instance


\begin{DoxyParams}{Parameters}
{\em type} & the singleton type \\
\hline
{\em init} & the singleton init func \\
\hline
{\em exit} & the singleton exit func \\
\hline
{\em kill} & the singleton kill func\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the singleton instance handle 
\end{DoxyReturn}


Definition at line 117 of file singleton.\-c.



Referenced by tb\-\_\-pool().

\hypertarget{singleton_8h_a65dc60604d75063ea918963be7e96f1a}{\index{singleton.\-h@{singleton.\-h}!tb\-\_\-singleton\-\_\-kill@{tb\-\_\-singleton\-\_\-kill}}
\index{tb\-\_\-singleton\-\_\-kill@{tb\-\_\-singleton\-\_\-kill}!singleton.h@{singleton.\-h}}
\subsubsection[{tb\-\_\-singleton\-\_\-kill}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-singleton\-\_\-kill (
\begin{DoxyParamCaption}
\item[{tb\-\_\-noarg\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{singleton_8h_a65dc60604d75063ea918963be7e96f1a}
kill singleton \hypertarget{singleton_8h_a577bbab4c6744ec29087ef1b25e83ed0}{\index{singleton.\-h@{singleton.\-h}!tb\-\_\-singleton\-\_\-static\-\_\-init@{tb\-\_\-singleton\-\_\-static\-\_\-init}}
\index{tb\-\_\-singleton\-\_\-static\-\_\-init@{tb\-\_\-singleton\-\_\-static\-\_\-init}!singleton.h@{singleton.\-h}}
\subsubsection[{tb\-\_\-singleton\-\_\-static\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-singleton\-\_\-static\-\_\-init (
\begin{DoxyParamCaption}
\item[{tb\-\_\-atomic\-\_\-t $\ast$}]{binited, }
\item[{tb\-\_\-handle\-\_\-t}]{instance, }
\item[{{\bf tb\-\_\-singleton\-\_\-static\-\_\-init\-\_\-func\-\_\-t}}]{init}
\end{DoxyParamCaption}
)}}\label{singleton_8h_a577bbab4c6744ec29087ef1b25e83ed0}
the singleton static instance


\begin{DoxyCode}
\textcolor{keyword}{static} tb\_bool\_t tb\_xxxx\_instance\_init(tb\_handle\_t instance)
\{
    \textcolor{comment}{// init }
    \textcolor{comment}{// ...}

    \textcolor{comment}{// ok}
    \textcolor{keywordflow}{return} tb\_true;
\}
tb\_xxxx\_t* tb\_xxxx()
\{
    \textcolor{comment}{// init}
    \textcolor{keyword}{static} tb\_atomic\_t      s\_binited = 0;
    \textcolor{keyword}{static} tb\_xxxx\_t        s\_xxxx = \{0\};

    \textcolor{comment}{// init the static instance}
    tb\_bool\_t ok = \hyperlink{singleton_8c_a577bbab4c6744ec29087ef1b25e83ed0}{tb\_singleton\_static\_init}(&s\_binited, &s\_xxxx, 
      tb\_xxxx\_instance\_init);
    tb\_assert(ok);

    \textcolor{comment}{// ok}
    \textcolor{keywordflow}{return} &s\_xxxx;
\}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em binited} & the singleton static instance is inited? \\
\hline
{\em instance} & the singleton static instance \\
\hline
{\em init} & the singleton static init func\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 163 of file singleton.\-c.

