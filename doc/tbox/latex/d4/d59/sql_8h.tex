\hypertarget{sql_8h}{\section{src/tbox/database/sql.h File Reference}
\label{sql_8h}\index{src/tbox/database/sql.\-h@{src/tbox/database/sql.\-h}}
}
{\ttfamily \#include \char`\"{}prefix.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}value.\-h\char`\"{}}\\*
Include dependency graph for sql.\-h\-:
This graph shows which files directly or indirectly include this file\-:
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}
\begin{DoxyCompactList}\small\item\em the database sql ref type \end{DoxyCompactList}\item 
struct \hyperlink{structtb__database__sql__statement__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t}
\begin{DoxyCompactList}\small\item\em the database sql statement ref type \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{sql_8h_af20d4c6c5db540bb81f67b3c9a463d65}{tb\-\_\-database\-\_\-sql\-\_\-type\-\_\-e} \{ {\bfseries T\-B\-\_\-\-D\-A\-T\-A\-B\-A\-S\-E\-\_\-\-S\-Q\-L\-\_\-\-T\-Y\-P\-E\-\_\-\-N\-O\-N\-E} = 0, 
{\bfseries T\-B\-\_\-\-D\-A\-T\-A\-B\-A\-S\-E\-\_\-\-S\-Q\-L\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-Y\-S\-Q\-L} = 1, 
{\bfseries T\-B\-\_\-\-D\-A\-T\-A\-B\-A\-S\-E\-\_\-\-S\-Q\-L\-\_\-\-T\-Y\-P\-E\-\_\-\-S\-Q\-L\-I\-T\-E3} = 2
 \}
\begin{DoxyCompactList}\small\item\em the sql database type enum \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} \hyperlink{sql_8h_a4926302f607fbd65ccb9f5dd2604c4b7}{tb\-\_\-database\-\_\-sql\-\_\-init} (tb\-\_\-char\-\_\-t const $\ast$url)
\item 
tb\-\_\-void\-\_\-t \hyperlink{sql_8h_a7cd80da21f87dcaf99c53d9d142237c0}{tb\-\_\-database\-\_\-sql\-\_\-exit} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-size\-\_\-t \hyperlink{sql_8h_a57d547053fa777233e2964f9cf39e3e4}{tb\-\_\-database\-\_\-sql\-\_\-type} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_aa3fcb49dc7f80e640d79335fae8063d8}{tb\-\_\-database\-\_\-sql\-\_\-open} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-void\-\_\-t \hyperlink{sql_8h_a49626a54c2a95d8fabac2582a5400b48}{tb\-\_\-database\-\_\-sql\-\_\-clos} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_ab67ddee3f853a5ea6338093a6d92924d}{tb\-\_\-database\-\_\-sql\-\_\-begin} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_a0bff3ed05e0aa9812caaf799db199e19}{tb\-\_\-database\-\_\-sql\-\_\-commit} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_a83468fd0b7c46170bb1b8a474a990d23}{tb\-\_\-database\-\_\-sql\-\_\-rollback} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-size\-\_\-t \hyperlink{sql_8h_a655bf85608cae8923064e43253116ae1}{tb\-\_\-database\-\_\-sql\-\_\-state} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_a0988a4da7fef9be4637bf4c069fda425}{tb\-\_\-database\-\_\-sql\-\_\-done} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, tb\-\_\-char\-\_\-t const $\ast$sql)
\item 
\hyperlink{iterator_8h_ac27e510c3327a31ba3bf561fbfafdd95}{tb\-\_\-iterator\-\_\-ref\-\_\-t} \hyperlink{sql_8h_a89c4bdc4023c78c1d62b3604250c5614}{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, tb\-\_\-bool\-\_\-t try\-\_\-all)
\item 
tb\-\_\-void\-\_\-t \hyperlink{sql_8h_ae8771b4f18600c595d1bbb0750bc2e31}{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, \hyperlink{iterator_8h_ac27e510c3327a31ba3bf561fbfafdd95}{tb\-\_\-iterator\-\_\-ref\-\_\-t} result)
\item 
\hyperlink{structtb__database__sql__statement__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t} \hyperlink{sql_8h_aa4c60f2142284518c6883ff5161f8757}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, tb\-\_\-char\-\_\-t const $\ast$sql)
\item 
tb\-\_\-void\-\_\-t \hyperlink{sql_8h_a627b74ebb232152c7517c1ab7efeba5c}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, \hyperlink{structtb__database__sql__statement__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t} statement)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_a3ec4b5aee2705ffae1ed0c00adcb463f}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, \hyperlink{structtb__database__sql__statement__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t} statement)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{sql_8h_adf0e574390a68772ef8d35c3fd37929f}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind} (\hyperlink{structtb__database__sql__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} database, \hyperlink{structtb__database__sql__statement__ref__t}{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t} statement, \hyperlink{structtb__database__sql__value__t}{tb\-\_\-database\-\_\-sql\-\_\-value\-\_\-t} const $\ast$list, tb\-\_\-size\-\_\-t size)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Treasure Box Library

T\-Box is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; either version 2.\-1 of the License, or (at your option) any later version.

T\-Box is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U Lesser General Public License for more details.

You should have received a copy of the G\-N\-U Lesser General Public License along with T\-Box; If not, see \href{http://www.gnu.org/licenses/}{\tt http\-://www.\-gnu.\-org/licenses/}

Copyright (C) 2009 -\/ 2015, ruki All rights reserved.

\begin{DoxyAuthor}{Author}
ruki 
\end{DoxyAuthor}


Definition in file \hyperlink{sql_8h_source}{sql.\-h}.



\subsection{Function Documentation}
\hypertarget{sql_8h_ab67ddee3f853a5ea6338093a6d92924d}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-begin@{tb\-\_\-database\-\_\-sql\-\_\-begin}}
\index{tb\-\_\-database\-\_\-sql\-\_\-begin@{tb\-\_\-database\-\_\-sql\-\_\-begin}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-begin}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-begin (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_ab67ddee3f853a5ea6338093a6d92924d}
begin transaction


\begin{DoxyParams}{Parameters}
{\em database} & the database handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 212 of file sql.\-c.

\hypertarget{sql_8h_a49626a54c2a95d8fabac2582a5400b48}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-clos@{tb\-\_\-database\-\_\-sql\-\_\-clos}}
\index{tb\-\_\-database\-\_\-sql\-\_\-clos@{tb\-\_\-database\-\_\-sql\-\_\-clos}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-clos}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-clos (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_a49626a54c2a95d8fabac2582a5400b48}
clos database


\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
\end{DoxyParams}


Definition at line 185 of file sql.\-c.

\hypertarget{sql_8h_a0bff3ed05e0aa9812caaf799db199e19}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-commit@{tb\-\_\-database\-\_\-sql\-\_\-commit}}
\index{tb\-\_\-database\-\_\-sql\-\_\-commit@{tb\-\_\-database\-\_\-sql\-\_\-commit}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-commit}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-commit (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_a0bff3ed05e0aa9812caaf799db199e19}
commit transaction


\begin{DoxyParams}{Parameters}
{\em database} & the database handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 233 of file sql.\-c.

\hypertarget{sql_8h_a0988a4da7fef9be4637bf4c069fda425}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-done@{tb\-\_\-database\-\_\-sql\-\_\-done}}
\index{tb\-\_\-database\-\_\-sql\-\_\-done@{tb\-\_\-database\-\_\-sql\-\_\-done}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-done (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{tb\-\_\-char\-\_\-t const $\ast$}]{sql}
\end{DoxyParamCaption}
)}}\label{sql_8h_a0988a4da7fef9be4637bf4c069fda425}
done database


\begin{DoxyCode}
\textcolor{comment}{// done sql}
\textcolor{keywordflow}{if} (!\hyperlink{sql_8c_a0988a4da7fef9be4637bf4c069fda425}{tb\_database\_sql\_done}(database, \textcolor{stringliteral}{"select * from table"}))
\{
    \textcolor{comment}{// trace}
    tb\_trace\_e(\textcolor{stringliteral}{"done sql failed, error: %s"}, \hyperlink{state_8c_a48ee63d9a88adadec69cda1d846e00aa}{tb\_state\_cstr}(
      \hyperlink{sql_8c_a655bf85608cae8923064e43253116ae1}{tb\_database\_sql\_state}(database)));
    return ;
\}

\textcolor{comment}{// load result}
\textcolor{comment}{// ..}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em sql} & the sql command\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 275 of file sql.\-c.

\hypertarget{sql_8h_a7cd80da21f87dcaf99c53d9d142237c0}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-exit@{tb\-\_\-database\-\_\-sql\-\_\-exit}}
\index{tb\-\_\-database\-\_\-sql\-\_\-exit@{tb\-\_\-database\-\_\-sql\-\_\-exit}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-exit (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_a7cd80da21f87dcaf99c53d9d142237c0}
exit database


\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
\end{DoxyParams}


Definition at line 140 of file sql.\-c.



Referenced by tb\-\_\-database\-\_\-sql\-\_\-init().

\hypertarget{sql_8h_a4926302f607fbd65ccb9f5dd2604c4b7}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-init@{tb\-\_\-database\-\_\-sql\-\_\-init}}
\index{tb\-\_\-database\-\_\-sql\-\_\-init@{tb\-\_\-database\-\_\-sql\-\_\-init}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t} tb\-\_\-database\-\_\-sql\-\_\-init (
\begin{DoxyParamCaption}
\item[{tb\-\_\-char\-\_\-t const $\ast$}]{url}
\end{DoxyParamCaption}
)}}\label{sql_8h_a4926302f607fbd65ccb9f5dd2604c4b7}
init sql database


\begin{DoxyParams}{Parameters}
{\em url} & the database url \char`\"{}sql\-://localhost/?type=mysql\&username=xxxx\&password=xxxx\char`\"{} \char`\"{}sql\-://localhost\-:3306/?type=mysql\&username=xxxx\&password=xxxx\&database=xxxx\char`\"{} \char`\"{}sql\-:///home/file.\-sqlitedb?type=sqlite3\char`\"{} \char`\"{}/home/file.\-sqlite3\char`\"{} \char`\"{}file\-:///home/file.\-sqlitedb\char`\"{} \char`\"{}\-C\-://home/file.\-sqlite3\char`\"{}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the database 
\end{DoxyReturn}


Definition at line 39 of file sql.\-c.



References tb\-\_\-database\-\_\-sql\-\_\-exit().

\hypertarget{sql_8h_aa3fcb49dc7f80e640d79335fae8063d8}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-open@{tb\-\_\-database\-\_\-sql\-\_\-open}}
\index{tb\-\_\-database\-\_\-sql\-\_\-open@{tb\-\_\-database\-\_\-sql\-\_\-open}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-open}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-open (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_aa3fcb49dc7f80e640d79335fae8063d8}
open database


\begin{DoxyCode}
\hyperlink{structtb__database__sql__ref__t}{tb\_database\_sql\_ref\_t} database = \hyperlink{sql_8c_a4926302f607fbd65ccb9f5dd2604c4b7}{tb\_database\_sql\_init}(\textcolor{stringliteral}{"
      sql://localhost/?type=mysql&username=xxxx&password=xxxx"});
\textcolor{keywordflow}{if} (database)
\{
    \textcolor{comment}{// open it}
    \textcolor{keywordflow}{if} (\hyperlink{sql_8c_aa3fcb49dc7f80e640d79335fae8063d8}{tb\_database\_sql\_open}(database))
    \{
        \textcolor{comment}{// done it}
        \textcolor{comment}{// ...}

        \textcolor{comment}{// close it}
        \hyperlink{sql_8c_a49626a54c2a95d8fabac2582a5400b48}{tb\_database\_sql\_clos}(database);
    \}
    \hyperlink{sql_8c_a7cd80da21f87dcaf99c53d9d142237c0}{tb\_database\_sql\_exit}(database);
\}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em database} & the database handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 164 of file sql.\-c.

\hypertarget{sql_8h_ae8771b4f18600c595d1bbb0750bc2e31}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit@{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit}}
\index{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit@{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-exit (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{{\bf tb\-\_\-iterator\-\_\-ref\-\_\-t}}]{result}
\end{DoxyParamCaption}
)}}\label{sql_8h_ae8771b4f18600c595d1bbb0750bc2e31}
exit the database result


\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em result} & the database result \\
\hline
\end{DoxyParams}


Definition at line 320 of file sql.\-c.

\hypertarget{sql_8h_a89c4bdc4023c78c1d62b3604250c5614}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load@{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load}}
\index{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load@{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-iterator\-\_\-ref\-\_\-t} tb\-\_\-database\-\_\-sql\-\_\-result\-\_\-load (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{tb\-\_\-bool\-\_\-t}]{try\-\_\-all}
\end{DoxyParamCaption}
)}}\label{sql_8h_a89c4bdc4023c78c1d62b3604250c5614}
load the database result


\begin{DoxyCode}
\textcolor{comment}{// done sql}
\textcolor{comment}{// ..}

\textcolor{comment}{// load result}
\hyperlink{structtb__iterator__t}{tb\_iterator\_ref\_t} result = \hyperlink{sql_8c_ac110c0cfacdf179179920fbfd573090c}{tb\_database\_sql\_result\_load}(database
      , tb\_true);
\textcolor{keywordflow}{if} (result)
\{
    \textcolor{comment}{// walk result}
    \hyperlink{for__if_8h_aedbf0e1ee47c33576315f1a70c14b022}{tb\_for\_all\_if} (\hyperlink{structtb__iterator__t}{tb\_iterator\_ref\_t}, row, result, row)
    \{
        \textcolor{comment}{// walk values}
        \hyperlink{for__if_8h_aedbf0e1ee47c33576315f1a70c14b022}{tb\_for\_all\_if} (\hyperlink{structtb__database__sql__value__t}{tb\_database\_sql\_value\_t}*, value, row, value)
        \{
           tb\_trace\_i(\textcolor{stringliteral}{"name: %s, data: %s, at: %lux%lu"}, tb\_database\_sql\_value\_name(value), 
      tb\_database\_sql\_value\_text(value), row\_itor, item\_itor);
        \}
    \}

    \textcolor{comment}{// exit result}
    \hyperlink{sql_8c_ae8771b4f18600c595d1bbb0750bc2e31}{tb\_database\_sql\_result\_exit}(result);
\}

\textcolor{comment}{// load result}
\hyperlink{structtb__iterator__t}{tb\_iterator\_ref\_t} result = \hyperlink{sql_8c_ac110c0cfacdf179179920fbfd573090c}{tb\_database\_sql\_result\_load}(database
      , tb\_false);
\textcolor{keywordflow}{if} (result)
\{
    \textcolor{comment}{// walk result}
    \hyperlink{for__if_8h_aedbf0e1ee47c33576315f1a70c14b022}{tb\_for\_all\_if} (\hyperlink{structtb__iterator__t}{tb\_iterator\_ref\_t}, row, result, row)
    \{
        \textcolor{comment}{// field count}
        tb\_trace\_i(\textcolor{stringliteral}{"count: %lu"}, \hyperlink{iterator_8c_adfba242e7ecc6d1aba26a0619be3412f}{tb\_iterator\_size}(row));

        \textcolor{comment}{// id}
        \hyperlink{structtb__database__sql__value__t}{tb\_database\_sql\_value\_t} \textcolor{keyword}{const}* \textcolor{keywordtype}{id} = 
      \hyperlink{iterator_8c_a22bc73cd45fc519a55f16346fe17114e}{tb\_iterator\_item}(row, 0);
        \textcolor{keywordflow}{if} (\textcolor{keywordtype}{id})
        \{
            tb\_trace\_i(\textcolor{stringliteral}{"id: %d"}, \hyperlink{value_8c_aac06d5ec8fcc5bfbc928bb7b965569f6}{tb\_database\_sql\_value\_int32}(\textcolor{keywordtype}{id}));
        \}

        \textcolor{comment}{// name}
        \hyperlink{structtb__database__sql__value__t}{tb\_database\_sql\_value\_t} \textcolor{keyword}{const}* name = 
      \hyperlink{iterator_8c_a22bc73cd45fc519a55f16346fe17114e}{tb\_iterator\_item}(row, 1);
        \textcolor{keywordflow}{if} (name)
        \{
            tb\_trace\_i(\textcolor{stringliteral}{"name: %s"}, tb\_database\_sql\_value\_text(name));
        \}

        \textcolor{comment}{// blob}
        \hyperlink{structtb__database__sql__value__t}{tb\_database\_sql\_value\_t} \textcolor{keyword}{const}* blob = 
      \hyperlink{iterator_8c_a22bc73cd45fc519a55f16346fe17114e}{tb\_iterator\_item}(row, 2);
        \textcolor{keywordflow}{if} (blob)
        \{
            \textcolor{comment}{// data?}
            \hyperlink{structtb__stream__ref__t}{tb\_stream\_ref\_t} stream = tb\_null;
            \textcolor{keywordflow}{if} (tb\_database\_sql\_value\_blob(blob))
            \{
                \textcolor{comment}{// trace}
                tb\_trace\_i(\textcolor{stringliteral}{"[data: %p, size: %lu] "}, tb\_database\_sql\_value\_blob(blob), 
      \hyperlink{value_8c_a386eabebb2e741e5cf85078d08f55727}{tb\_database\_sql\_value\_size}(blob));
            \}
            \textcolor{comment}{// stream?}
            \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((stream = tb\_database\_sql\_value\_blob\_stream(blob)))
            \{
                \textcolor{comment}{// trace}
                tb\_trace\_i(\textcolor{stringliteral}{"[stream: %p, size: %lld] "}, stream, \hyperlink{stream_8c_a087a1be89b1a720d8876850c787c850c}{tb\_stream\_size}(stream));

                \textcolor{comment}{// read stream}
                \textcolor{comment}{// ...}
            \}
            \textcolor{comment}{// null?}
            \textcolor{keywordflow}{else}
            \{
                \textcolor{comment}{// trace}
                tb\_trace\_i(\textcolor{stringliteral}{"[%s:null] "}, tb\_database\_sql\_value\_name(blob));
            \}
        \}

    \}

    \textcolor{comment}{// exit result}
    \hyperlink{sql_8c_ae8771b4f18600c595d1bbb0750bc2e31}{tb\_database\_sql\_result\_exit}(result);
\}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em try\-\_\-all} & try loading all result into memory\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the database result 
\end{DoxyReturn}


Definition at line 299 of file sql.\-c.

\hypertarget{sql_8h_a83468fd0b7c46170bb1b8a474a990d23}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-rollback@{tb\-\_\-database\-\_\-sql\-\_\-rollback}}
\index{tb\-\_\-database\-\_\-sql\-\_\-rollback@{tb\-\_\-database\-\_\-sql\-\_\-rollback}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-rollback}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-rollback (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_a83468fd0b7c46170bb1b8a474a990d23}
rollback transaction


\begin{DoxyParams}{Parameters}
{\em database} & the database handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 254 of file sql.\-c.

\hypertarget{sql_8h_a655bf85608cae8923064e43253116ae1}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-state@{tb\-\_\-database\-\_\-sql\-\_\-state}}
\index{tb\-\_\-database\-\_\-sql\-\_\-state@{tb\-\_\-database\-\_\-sql\-\_\-state}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-size\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-state (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_a655bf85608cae8923064e43253116ae1}
the database state


\begin{DoxyParams}{Parameters}
{\em database} & the database handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the database state 
\end{DoxyReturn}


Definition at line 203 of file sql.\-c.

\hypertarget{sql_8h_adf0e574390a68772ef8d35c3fd37929f}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind}}
\index{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-bind (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t}}]{statement, }
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-value\-\_\-t} const $\ast$}]{list, }
\item[{tb\-\_\-size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{sql_8h_adf0e574390a68772ef8d35c3fd37929f}
bind the database statement argument


\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em statement} & the statement handle \\
\hline
{\em list} & the argument value list \\
\hline
{\em size} & the argument value count\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 392 of file sql.\-c.

\hypertarget{sql_8h_a3ec4b5aee2705ffae1ed0c00adcb463f}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done}}
\index{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-done (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t}}]{statement}
\end{DoxyParamCaption}
)}}\label{sql_8h_a3ec4b5aee2705ffae1ed0c00adcb463f}
done the database statement


\begin{DoxyCode}
\hyperlink{structtb__database__sql__statement__ref__t}{tb\_database\_sql\_statement\_ref\_t} statement = 
      \hyperlink{sql_8c_aa4c60f2142284518c6883ff5161f8757}{tb\_database\_sql\_statement\_init}(database, \textcolor{stringliteral}{"select * from table where id=?"});
\textcolor{keywordflow}{if} (statement)
\{
    \textcolor{comment}{// bind arguments}
    \hyperlink{structtb__database__sql__value__t}{tb\_database\_sql\_value\_t} list[1] = \{0\};
    \hyperlink{value_8c_a3d8e4a869f0b6056899580e9365308f7}{tb\_database\_sql\_value\_set\_int32}(&list[0], 12345);
    \textcolor{keywordflow}{if} (\hyperlink{sql_8c_adf0e574390a68772ef8d35c3fd37929f}{tb\_database\_sql\_statement\_bind}(database, statement, list, tb\_arrayn(
      list)))
    \{
        \textcolor{comment}{// done statement}
        \textcolor{keywordflow}{if} (\hyperlink{sql_8c_a3ec4b5aee2705ffae1ed0c00adcb463f}{tb\_database\_sql\_statement\_done}(database, statement))
        \{
            \textcolor{comment}{// load result}
            \textcolor{comment}{// ...}
        \}
    \}

    \textcolor{comment}{// exit statement}
    \hyperlink{sql_8c_a627b74ebb232152c7517c1ab7efeba5c}{tb\_database\_sql\_statement\_exit}(database, statement);
\}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em statement} & the statement handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 371 of file sql.\-c.

\hypertarget{sql_8h_a627b74ebb232152c7517c1ab7efeba5c}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit}}
\index{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-void\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-exit (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t}}]{statement}
\end{DoxyParamCaption}
)}}\label{sql_8h_a627b74ebb232152c7517c1ab7efeba5c}
exit the database statement


\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em statement} & the statement handle \\
\hline
\end{DoxyParams}


Definition at line 356 of file sql.\-c.

\hypertarget{sql_8h_aa4c60f2142284518c6883ff5161f8757}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init}}
\index{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init@{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-ref\-\_\-t} tb\-\_\-database\-\_\-sql\-\_\-statement\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database, }
\item[{tb\-\_\-char\-\_\-t const $\ast$}]{sql}
\end{DoxyParamCaption}
)}}\label{sql_8h_aa4c60f2142284518c6883ff5161f8757}
init the database statement


\begin{DoxyParams}{Parameters}
{\em database} & the database handle \\
\hline
{\em sql} & the sql command\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the statement handle 
\end{DoxyReturn}


Definition at line 335 of file sql.\-c.

\hypertarget{sql_8h_a57d547053fa777233e2964f9cf39e3e4}{\index{sql.\-h@{sql.\-h}!tb\-\_\-database\-\_\-sql\-\_\-type@{tb\-\_\-database\-\_\-sql\-\_\-type}}
\index{tb\-\_\-database\-\_\-sql\-\_\-type@{tb\-\_\-database\-\_\-sql\-\_\-type}!sql.h@{sql.\-h}}
\subsubsection[{tb\-\_\-database\-\_\-sql\-\_\-type}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-size\-\_\-t tb\-\_\-database\-\_\-sql\-\_\-type (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-database\-\_\-sql\-\_\-ref\-\_\-t}}]{database}
\end{DoxyParamCaption}
)}}\label{sql_8h_a57d547053fa777233e2964f9cf39e3e4}
the database type


\begin{DoxyParams}{Parameters}
{\em database} & the database handle\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the database type 
\end{DoxyReturn}


Definition at line 155 of file sql.\-c.

