\hypertarget{singleton_8c}{\section{src/tbox/utils/singleton.c File Reference}
\label{singleton_8c}\index{src/tbox/utils/singleton.\-c@{src/tbox/utils/singleton.\-c}}
}
{\ttfamily \#include \char`\"{}singleton.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../libc/libc.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../platform/platform.\-h\char`\"{}}\\*
Include dependency graph for singleton.\-c\-:
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{singleton_8c_a2aa61763aba311653f75dfdea928da4e}{\#define {\bfseries T\-B\-\_\-\-T\-R\-A\-C\-E\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-N\-A\-M\-E}~\char`\"{}singleton\char`\"{}}\label{singleton_8c_a2aa61763aba311653f75dfdea928da4e}

\item 
\hypertarget{singleton_8c_ab5dd5585b246c36fdb275f9781170000}{\#define {\bfseries T\-B\-\_\-\-T\-R\-A\-C\-E\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-D\-E\-B\-U\-G}~(0)}\label{singleton_8c_ab5dd5585b246c36fdb275f9781170000}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{singleton_8c_abf5c0ac06eebaaf637c9015ff4e9e9f1}{tb\-\_\-bool\-\_\-t {\bfseries tb\-\_\-singleton\-\_\-init} ()}\label{singleton_8c_abf5c0ac06eebaaf637c9015ff4e9e9f1}

\item 
\hypertarget{singleton_8c_a54f91110567dcb4a4143a931775440e5}{tb\-\_\-void\-\_\-t {\bfseries tb\-\_\-singleton\-\_\-kill} ()}\label{singleton_8c_a54f91110567dcb4a4143a931775440e5}

\item 
\hypertarget{singleton_8c_a5f294f47d2c79a238194929a557728bf}{tb\-\_\-void\-\_\-t {\bfseries tb\-\_\-singleton\-\_\-exit} ()}\label{singleton_8c_a5f294f47d2c79a238194929a557728bf}

\item 
tb\-\_\-handle\-\_\-t \hyperlink{singleton_8c_ae2d051d2b0f9d1e57edc719bafb025d1}{tb\-\_\-singleton\-\_\-instance} (tb\-\_\-size\-\_\-t type, \hyperlink{singleton_8h_a1aa604a7c38032e84c3128fed7238692}{tb\-\_\-singleton\-\_\-init\-\_\-func\-\_\-t} init, \hyperlink{singleton_8h_a669c643f7499cd3c0bab71ede1fd3bc6}{tb\-\_\-singleton\-\_\-exit\-\_\-func\-\_\-t} exit, \hyperlink{singleton_8h_a809be072c9425771e250cefd90ea72e0}{tb\-\_\-singleton\-\_\-kill\-\_\-func\-\_\-t} kill)
\item 
tb\-\_\-bool\-\_\-t \hyperlink{singleton_8c_a577bbab4c6744ec29087ef1b25e83ed0}{tb\-\_\-singleton\-\_\-static\-\_\-init} (tb\-\_\-atomic\-\_\-t $\ast$binited, tb\-\_\-handle\-\_\-t instance, \hyperlink{singleton_8h_aea8cb52294807ccfcf575f42ed4253c7}{tb\-\_\-singleton\-\_\-static\-\_\-init\-\_\-func\-\_\-t} init)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Treasure Box Library

T\-Box is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; either version 2.\-1 of the License, or (at your option) any later version.

T\-Box is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U Lesser General Public License for more details.

You should have received a copy of the G\-N\-U Lesser General Public License along with T\-Box; If not, see \href{http://www.gnu.org/licenses/}{\tt http\-://www.\-gnu.\-org/licenses/}

Copyright (C) 2009 -\/ 2015, ruki All rights reserved.

\begin{DoxyAuthor}{Author}
ruki 
\end{DoxyAuthor}


Definition in file \hyperlink{singleton_8c_source}{singleton.\-c}.



\subsection{Function Documentation}
\hypertarget{singleton_8c_ae2d051d2b0f9d1e57edc719bafb025d1}{\index{singleton.\-c@{singleton.\-c}!tb\-\_\-singleton\-\_\-instance@{tb\-\_\-singleton\-\_\-instance}}
\index{tb\-\_\-singleton\-\_\-instance@{tb\-\_\-singleton\-\_\-instance}!singleton.c@{singleton.\-c}}
\subsubsection[{tb\-\_\-singleton\-\_\-instance}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-handle\-\_\-t tb\-\_\-singleton\-\_\-instance (
\begin{DoxyParamCaption}
\item[{tb\-\_\-size\-\_\-t}]{type, }
\item[{{\bf tb\-\_\-singleton\-\_\-init\-\_\-func\-\_\-t}}]{init, }
\item[{{\bf tb\-\_\-singleton\-\_\-exit\-\_\-func\-\_\-t}}]{exit, }
\item[{{\bf tb\-\_\-singleton\-\_\-kill\-\_\-func\-\_\-t}}]{kill}
\end{DoxyParamCaption}
)}}\label{singleton_8c_ae2d051d2b0f9d1e57edc719bafb025d1}
the singleton instance


\begin{DoxyParams}{Parameters}
{\em type} & the singleton type \\
\hline
{\em init} & the singleton init func \\
\hline
{\em exit} & the singleton exit func \\
\hline
{\em kill} & the singleton kill func\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the singleton instance handle 
\end{DoxyReturn}


Definition at line 117 of file singleton.\-c.



Referenced by tb\-\_\-pool().

\hypertarget{singleton_8c_a577bbab4c6744ec29087ef1b25e83ed0}{\index{singleton.\-c@{singleton.\-c}!tb\-\_\-singleton\-\_\-static\-\_\-init@{tb\-\_\-singleton\-\_\-static\-\_\-init}}
\index{tb\-\_\-singleton\-\_\-static\-\_\-init@{tb\-\_\-singleton\-\_\-static\-\_\-init}!singleton.c@{singleton.\-c}}
\subsubsection[{tb\-\_\-singleton\-\_\-static\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}tb\-\_\-bool\-\_\-t tb\-\_\-singleton\-\_\-static\-\_\-init (
\begin{DoxyParamCaption}
\item[{tb\-\_\-atomic\-\_\-t $\ast$}]{binited, }
\item[{tb\-\_\-handle\-\_\-t}]{instance, }
\item[{{\bf tb\-\_\-singleton\-\_\-static\-\_\-init\-\_\-func\-\_\-t}}]{init}
\end{DoxyParamCaption}
)}}\label{singleton_8c_a577bbab4c6744ec29087ef1b25e83ed0}
the singleton static instance


\begin{DoxyCode}
\textcolor{keyword}{static} tb\_bool\_t tb\_xxxx\_instance\_init(tb\_handle\_t instance)
\{
    \textcolor{comment}{// init }
    \textcolor{comment}{// ...}

    \textcolor{comment}{// ok}
    \textcolor{keywordflow}{return} tb\_true;
\}
tb\_xxxx\_t* tb\_xxxx()
\{
    \textcolor{comment}{// init}
    \textcolor{keyword}{static} tb\_atomic\_t      s\_binited = 0;
    \textcolor{keyword}{static} tb\_xxxx\_t        s\_xxxx = \{0\};

    \textcolor{comment}{// init the static instance}
    tb\_bool\_t ok = \hyperlink{singleton_8c_a577bbab4c6744ec29087ef1b25e83ed0}{tb\_singleton\_static\_init}(&s\_binited, &s\_xxxx, 
      tb\_xxxx\_instance\_init);
    tb\_assert(ok);

    \textcolor{comment}{// ok}
    \textcolor{keywordflow}{return} &s\_xxxx;
\}
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em binited} & the singleton static instance is inited? \\
\hline
{\em instance} & the singleton static instance \\
\hline
{\em init} & the singleton static init func\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tb\-\_\-true or tb\-\_\-false 
\end{DoxyReturn}


Definition at line 163 of file singleton.\-c.

